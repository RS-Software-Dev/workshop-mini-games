<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game of Life</title>

    <style>
        body {
            background-color: black;
            color: white;
            font-family: monospace;
        }

        main,
        header {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }


        canvas {
            border: 2px solid white;
        }
    </style>

    <script type="text/javascript">

        class GameGrid {
            #rows
            #cols
            #data

            constructor({ rows, cols, make }) {
                this.#rows = rows
                this.#cols = cols
                this.#data = [...Array(cols).keys().map(x => [...Array(rows).keys().map(y => make({ x: x, y: y }))])]
            }

            get text() {
                return JSON.stringify(this.#data)
            }

            isInside({ x, y }) {
                return (0 <= x && x <= this.#data.length)
                    && (0 <= y && y <= this.#data[x].length)
            }

            

            cell({ x, y }) {
                return {
                            x: x,
                            y: y,

                            get isInside() {

                            },

                            get data() {

                            },

                            *neighbors() {

                            }


                        }
                if (0 <= x && x <= this.#data.length) {
                    if (0 <= y && y <= this.#data[x].length) {
                        
                    }
                }
            }

            *cells() {
                for (let x = 0; x < this.#data.length; x++) {
                    for (let y = 0; y < this.#data[x].length; y++) {
                        yield this.cell({
                            x: x,
                            y: y
                        })
                    }
                }
            }

            *neighbors({ x, y }) {
                for (let dx = -1; dx <= +1; dx++) {
                    for (let dy = -1; dy <= +1; dy++) {
                        if (dx != 0 && dy != 0) {
                            yield this.cell({
                                x: x + dx,
                                y: y + dy
                            })
                        }
                    }
                }
            }

            countNeighbors(pos) {
                var count = 0

                for (const cell of neighbors(pos)) {
                    if (cell) {
                        count += 1
                    }
                }

                return count
            }
        }
    </script>
</head>

<body>
    <header>
        <h1>Game of Life</h1>
    </header>

    <main>
        <canvas id="view" width="320" height="320"></canvas>
        <canvas width="320" height="640">
        </canvas>
    </main>
    <script>
        let canvas = document.getElementById('view')
        let context = canvas.getContext('2d')

        const TILE_SIZE = 16;

        class GameData {

        }

        class GameView {
            constructor({ canvas }) {
                this.canvas = canvas
                this.context = canvas.getContext('2d')
            }

            static get currentParent() {
                return new GameView({
                    canvas: document.currentScript.parentNode
                })
            }

            get width() {
                return this.canvas.width
            }
        }



        function clearCanvas() {
            context.clearRect(0, 0, canvas.width, canvas.height)
        }

        function fillTile({ x, y }) {
            context.beginPath()
            context.roundRect(x * TILE_SIZE + 1, y * TILE_SIZE + 1, TILE_SIZE - 2, TILE_SIZE - 2, TILE_SIZE / 8)
            context.fill()
        }

        function drawLivingCell(pos) {
            context.fillStyle = "cyan"
            fillTile(pos)
        }

        function drawDeadCell(pos) {
            context.fillStyle = "darkgray"
            fillTile(pos)
        }

        /*
        function render() {
            clearCanvas()
            for (let cell of grid.cells()) {
                if (cell.val == true) {
                    drawLivingCell(cell)
                }
                else {
                    drawDeadCell(cell)
                }
            }
        }

        window.onload = render
        */
    </script>

    <script defer>
        function *generator() {
            console.dir(Array( 10).keys())
            for(let i in Array(10).fill(0)) {
                console.log('iterare')
                yield i
            }
        }

        for(const gen of generator()) {
            console.log('gen', gen)
        }

        
    </script>
</body>

</html>